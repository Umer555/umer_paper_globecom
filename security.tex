\section{Security Analysis}
\label{sec:security}

Data files $\langle \mathcal{F}_1, \mathcal{F}_2, \ldots,
\mathcal{F}_n \rangle$ are stored on cloud server after encryption and index
files $\langle \mathcal{I}_1, \mathcal{I}_2, \ldots,
\mathcal{I}_n \rangle$ are stored as condensed bloom filters, encrypted with
$\sigma_{pk}$. An entity with private keys $\sigma_{sk}$ can only decrypt and
access keywords stored in $\mathcal{I}$. $\sigma_{sk}$ will only be shared to
authorized entities to whom data owner wants to allow searching. All the
comparisons are being done anonymously by using homomorphic properties of Pascal
Paillier encryption~\cite{pascal}.

For detailed security analysis of our scheme, let suppose that Alice is the
owner of a small enterprise named Digitals. Alice wants to outsource her
employees related confidential data files $\mathcal{F} = \langle \mathcal{F}_1,
\mathcal{F}_2, \ldots, \mathcal{F}_n \rangle$ to the cloud server,
owned by Eve, in text format meanwhile she also wants to allow searching on the outsourced data
to his employee Bob, the HR manager of Digitals. Eve being a non-trusted third
party, Alice ensures privacy and confidentiality of $\mathcal{F}$ by
first encrypting $\mathcal{F}$ and corresponding index files $\mathcal{I}
= \langle \mathcal{I}_1, \mathcal{I}_2, \ldots, \mathcal{I}_n \rangle$ with
$\sigma_{pk}$ and then outsource them to cloud server.

\textbf{A.} Man in the middle attack

Let a malicious user M intercepts a user query $Q$. M cannot learn about $Q$ as
he does not have $\sigma_{sk}$ so $Q$ is secure. But M can manipulate $Q$ to
produce $\acute{Q}$. M can replace $k\omega$ in $Q$ with his own
$\acute{k}\omega$ encrypted with $\sigma_{pk}$. Eve won't notice if the query is been altered in
the midaway or not. Eve will evaulate the query and sends $\mathcal{R}_q$ to the user.
User will also won't notice that $\mathcal{R}_q$ is the outcome of an altered query.
He might notice unwanted information in the result but won't notice the missing
records due to replacement of his keyword by M.

\textbf{B.} Malicious Eve

Let Eve has some malicious intentions and wants to know about indexes and user
queries. As Eve won’t have $\sigma_{sk}$ so he cannot decrypt the indexes thus
cannot learn anything. Also, all the comparisons between bloom filter of user
query and indexes are being done by using additive homomorphic properties of
Pascal Paillier~\cite{pascal_AHE} so Eve cannot determine the outcome of the
comparisons. Neither he could determine any search pattern for subsequent queries from different users.

\textbf{C.} Insider Attack

Alice’s $\mathcal{F}$ and $\mathcal{I}$ will be secured against Insider attacks as
well. If some malicious employee E, who has access to Eve’s data centers, stole
Eve’s data then he won’t be able to access any useful information of Digitals
employees as without $\sigma_{sk}$ indexes cannot be decrypted.

\textbf{D.} Malicious user M and Eve teamed up

Let malicious user M having some background information of Digitals teamed up
with Eve to find out confidential information about Digitals employees. They
both cannot learn anything about the user query and the indexes on the cloud.
Malicious user cannot decrypt the user query and cloud server cannot know the comparisons output.

\textbf{E.} Malicious user’s random query

Let malicious user M having $\sigma_{pk}$, creates a semantically correct query
and sends to Eve for evaluation. Eve will perform comparisons and will return
$\mathcal{R}_q$ but M won’t be able to determine $\mathcal{M}_q$ as he does not
have the $\sigma_{sk}$ to decrypt $\mathcal{R}_q$ returned by Eve. He will
receive $\mathcal{R}_q$ set but he won’t be able to learn any information out of it.
